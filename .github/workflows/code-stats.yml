name: Update Code Stats

permissions:
  contents: write  # ðŸ‘ˆ æ·»åŠ è¿™ä¸€æ®µï¼Œå…è®¸ bot å†™å…¥å†…å®¹

on:
  push:
    branches: [ main ]
  schedule:
    - cron: '0 0 * * 0' # æ¯å‘¨è¿è¡Œä¸€æ¬¡
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Count lines of code
        run: |
          bash count_lines.sh > code_stats.md

      - name: Update README
        run: |
          sed -i '/<!-- CODE_STATS_START -->/,/<!-- CODE_STATS_END -->/c\<!-- CODE_STATS_START -->\n'"$(cat code_stats.md)"'\n<!-- CODE_STATS_END -->' README.md

      - name: Commit and push if changed
        run: |
          git config
